
%% FTMH_Goal function creates goals functions.

function z = FTMH_Goalnew(n)
TK=[232314,561630,2016152,221244];
ru=[926338
    1005006
    985714
    986028
    1059000
    1058582
    1019228
    997068
    902614
    961338
    963294
    933916];

d=[470  	630 	70  	630
    580	    770	    210  	710
    900   	690  	1020	220
    1210  	90	    1590   	0
    1220 	0	    1390   	0
    1020  	0	     270	0
    620    	0	      0	    0
    110	    0      	  0	    0
    0	    40	      0	    40
    0	    30	      0	    30
    0	    50  	  0   	50
    0	   230	      0	    230];
% data-----------------------------------
et=[470 	630 	70  	630
    580	    770	    210  	710
    900   	690  	1020	220
    1210  	90	    1590   	0
    1220 	0	    1390   	0
    1020  	0	     270	0
    620    	0	      0	    0
    110	    0      	  0	    0
    0	    40	      0	    40
    0	    30	      0	    30
    0	    50   	  0   	50
    0	   230	      0	   230];
etmax=[690	850	   220	   850
      890	1080   500	    1020
      1130	920    1260 	370
      1270	140	   1650	     0
      1220	0	   1390	     0
      1020	0	   270	     0
      620	0	   0	     0
      300	0	   0	     0
      0	   60	   0	    60
      0	   30      0	    30
      0	   50   	0	    50
      0	   360	    0	   360];
k=[0.4    1.1     0.4      1
    0.4    1.1    0.4     1
    0.5    0.4    0.8    0.4
    0.5    0.4    1.1     0
    1       0     1.1     0
    1       0     0.5     0
    0.4      0      0      0
    0.4     0       0      0
    0       0.4      0      0.4
    0       0.4      0      0.4
    0       0.5      0      0.5
    0       0.5      0      0.5];
k1=[.6 , .6 , .7,.6];

t=[6419, 10500, 5650,10200];
ymax=[8600,5500,30000,5500];   %[8600,3500,40000,3500] aslish

rfno3=0.46;
hm=12;      %input('Input hm as month value =  ');
hn=4;       %input('Input hn as product value =  ');

% global xf2
t1=1;
t2=2;
t3=3;
t4=4;
cw=1000;
cru=300;
c2_no3=0.07;
tf=[150, 200, 200, 150
    150, 200, 200, 150
    150, 200, 200, 150
    150, 200, 200,  0
    150,  0,  200,  0
    150,  0,  200,  0
    150,  0,  0,    0
    150,  0,  0,    0
    0,   200, 0,   150
    0,   200, 0,   150
    0,   200, 0,   150
    0,   200, 0,   150];
% tk=[2010400,551413,2601618,432407];
cf=8000;
c=30;
p1=4;
p2=80;
g1=0.4;
w=[.2;.3;.5];
% goal t1---------------------------------

f1 = 0 ; f2 = 0 ; f3 = 0 ;
xf1u = sum ( n (49 : 96));
xf1d = sum ( n (49 : 96)) + sum ( n (1 : 48)); 
xf2u =  sum ( n (49 : 96)) + sum ( n (1 : 48));
xf3u = c2_no3 * sum ( ( n (49 : 96)));
xf2d = 0;
xf3d=0;
for j = 1 : hn
    xf2d = xf2d + sum ( et (:,j)) * n ( 2*hm*hn + j);
    xf3d = xf3d + sum ( tf (:,j)) * n (2*hm*hn + j);
end 
 xf3d = rfno3 *xf3d ; 
xf1 = xf1u / xf1d;
xf2 = 1 - ( xf2u / xf2d );
xf3 = xf3u / xf3d;

%  f1
if xf1 <= 0.8 
    f1 = 1 - ( (5/4) * xf1 );
else 
    f1 = 0;
end
%   f2
if xf2 <= 0.2 
    f2 = 1;
elseif xf2 > 0.9
    f2 = 0;
else 
    f2 = (9/7) - ((10/7) * xf2 );
    
end
% f3
if xf3 >= 0.3
    f3 = 1;
else
    f3 = (10/3) *xf3;
end
    
z(t1)= - (  ((f1)^w(1))*((f2)^w(2))*((f3)^w(3))   );


% goal t2---------------------------------
z(t2) = ( ( (1-g1) * sum (n(1:48)) ) - ( g1* sum( n(49:96) ) )   );
% % goal t3---------------------------------
% % % z(t3)=0;
% % % g=zeros(hm,hn);
% % % for i=1:hm
% % %     for j=1:hn
% % %         temp = n((i-1)*hn+j)+n(hm*hn+(i-1)*hn+j) ;
% % %         if (temp) > 0
% % %             g(i,j) = (  (n((i-1)*hn+j)*p1+n(hm*hn+(i-1)*hn+j)*p2) / (temp)  ) - c;
% % %            
% % %             if g(i,j) > 0
% % %                 z(t3)=z(t3)+g(i,j);
% % %             else
% % %                 g(i,j) = 1 ;
% % %                 z(t3)=z(t3)+g(i,j);
% % %             end
% % %             
% % %         elseif temp == 0
% % %             g(i,j) = 0 ;
% % %         end        
% % %     end
% % % end
z(t3) = ( (xf1u * p2) +  (p1 * sum( n(1:48) ) ) ) / xf1d ;
% % goal t4---------------------------------
% ---------za2 fake
z_a2 = 0;
niyaz=[];
gama = zeros (1,4);
jamex = 0;
for j=1:hn
    jamex = 0;
    for i=1:hm
       jamex =  jamex+ n((i-1)*hn+j)+n(hm*hn+(i-1)*hn+j);
    end
    niyaz(j) = sum ( et (:,j)) * n ( 2*hm*hn + j);
%       z_a2 = z_a2 + .5*( jamex ./ niyaz(j) )*ymax(j)*n(2*hm*hn+j)*t(j);
      z_a2 = z_a2 + k1(j).*( jamex ./ niyaz(j) )*ymax(j)*n(2*hm*hn+j)*t(j);
      gama(j)  = k1(j).*( jamex ./ niyaz(j) );

end


% ---------------------
%calculating z_b
z_b = cw * sum (n (1:48));
        
 %calculating z_c
z_c = cru * sum (n (49:96));
%  calc z_d
z_d=0;
for j=1:hn
    z_d = z_d + TK(j) * n(2*hm*hn+j);
end
% calc z_e
 z_e=0;
B = zeros (1, 4);
% A = n(97:100);
for j = 1 : hn
    B(j) = sum ( tf (:,j) );
    z_e = z_e +   B (j) * n ( 2*hm*hn+j);
end

z_e = ((1 - ( c2_no3 *(sum (n (49:96))) / (rfno3*z_e) )) * z_e)*cf ;


 z(t4)=-(z_a2 -z_b -z_c -z_d -z_e);
% z(t4)=1/(z_a+z_b+z_c);
%----------------------------------------
%%constraint
% C=zeros(30,1);
% C(1)=12500-(n(97)+n(98)+n(99)+n(100));
% C(2)=(n(97)+n(98)+n(99)+n(100))-16500;
% C(3)=(n(49)+n(50)+n(51)+n(52))-ru(1,1);
% C(4)=(n(53)+n(54)+n(55)+n(56))-ru(2,1);
% C(5)=(n(57)+n(58)+n(59)+n(60))-ru(3,1);
% C(6)=(n(61)+n(62)+n(63)+n(64))-ru(4,1);
% C(7)=(n(65)+n(66)+n(67)+n(68))-ru(5,1);
% C(8)=(n(69)+n(70)+n(71)+n(72))-ru(6,1);
% C(9)=(n(73)+n(74)+n(75)+n(76))-ru(7,1);
% C(10)=(n(77)+n(78)+n(79)+n(80))-ru(8,1);
% C(11)=(n(81)+n(82)+n(83)+n(84))-ru(9,1);
% C(12)=(n(85)+n(86)+n(87)+n(88))-ru(10,1);
% C(13)=(n(89)+n(90)+n(91)+n(92))-ru(11,1);
% C(14)=(n(93)+n(94)+n(95)+n(96))-ru(12,1);
% % --------------------------------
% 
% C(15)=(n(1)+n(49)+n(2)+n(50)+n(3)+n(51)+n(4)+n(52))-((d(1,1))*n(97)+(d(1,2)*n(98))+(d(1,3)*n(99))+(d(1,4)*n(100)));
% % C(28)=0.7*((d(2,1)*n(97))+(d(2,2)*n(98))+(d(2,3)*n(99))+(d(2,4)*n(100)))-(n(5)+n(53)+n(6)+n(54)+n(7)+n(55)+n(8)+n(56));
% C(16)=(n(5)+n(53)+n(6)+n(54)+n(7)+n(55)+n(8)+n(56))-(d(2,1)*n(97)+d(2,2)*n(98)+d(2,3)*n(99)+d(2,4)*n(100));
% % C(30)=0.7*((d(3,1)*n(97))+(d(3,2)*n(98))+(d(3,3)*n(99))+(d(3,4)*n(100)))-(n(9)+n(57)+n(10)+n(58)+n(11)+n(59)+n(12)+n(60));
% C(17)=(n(9)+n(57)+n(10)+n(58)+n(11)+n(59)+n(12)+n(60))-((d(3,1)*n(97))+(d(3,2)*n(98))+(d(3,3)*n(99))+(d(3,4)*n(100)));
% % C(32)=0.7*((d(4,1)*n(97))+(d(4,2)*n(98))+(d(4,3)*n(99))+(d(4,4)*n(100)))-(n(13)+n(61)+n(14)+n(62)+n(15)+n(63)+n(16)+n(64));
% C(18)=(n(13)+n(61)+n(14)+n(62)+n(15)+n(63)+n(16)+n(64))-((d(4,1)*n(97))+(d(4,2)*n(98))+(d(4,3)*n(99))+(d(4,4)*n(100)));
% % C(34)=0.7*((d(5,1)*n(97))+(d(5,2)*n(98))+(d(5,3)*n(99))+(d(5,4)*n(100)))-(n(17)+n(65)+n(18)+n(66)+n(19)+n(67)+n(20)+n(68));
% C(19)=(n(17)+n(65)+n(18)+n(66)+n(19)+n(67)+n(20)+n(68))-((d(5,1)*n(97))+(d(5,2)*n(98))+(d(5,3)*n(99))+(d(5,4)*n(100)));
% % C(36)=0.7*((d(6,1)*n(97))+(d(6,2)*n(98))+(d(6,3)*n(99))+(d(6,4)*n(100)))-(n(21)+n(69)+n(22)+n(70)+n(23)+n(71)+n(24)+n(72));
% C(20)=(n(21)+n(69)+n(22)+n(70)+n(23)+n(71)+n(24)+n(72))-((d(6,1)*n(97))+(d(6,2)*n(98))+(d(6,3)*n(99))+(d(6,4)*n(100)));
% % C(38)=0.7*((d(7,1)*n(97))+(d(7,2)*n(98))+(d(7,3)*n(99))+(d(7,4)*n(100)))-(n(25)+n(73)+n(26)+n(74)+n(27)+n(75)+n(28)+n(76));
% C(21)=(n(25)+n(73)+n(26)+n(74)+n(27)+n(75)+n(28)+n(76))-((d(7,1)*n(97))+(d(7,2)*n(98))+(d(7,3)*n(99))+(d(7,4)*n(100)));
% % C(40)=0.7*((d(8,1)*n(97))+(d(8,2)*n(98))+(d(8,3)*n(99))+(d(8,4)*n(100)))-(n(29)+n(77)+n(30)+n(78)+n(31)+n(79)+n(32)+n(80));
% C(22)=(n(29)+n(77)+n(30)+n(78)+n(31)+n(79)+n(32)+n(80))-((d(8,1)*n(97))+(d(8,2)*n(98))+(d(8,3)*n(99))+(d(8,4)*n(100)));
% % C(42)=0.7*((d(9,1)*n(97))+(d(9,2)*n(98))+(d(9,3)*n(99))+(d(9,4)*n(100)))-(n(33)+n(81)+n(34)+n(82)+n(35)+n(83)+n(36)+n(84));
% C(23)=(n(33)+n(81)+n(34)+n(82)+n(35)+n(83)+n(36)+n(84))-((d(9,1)*n(97))+(d(9,2)*n(98))+(d(9,3)*n(99))+(d(9,4)*n(100)));
% % C(44)=0.7*((d(10,1)*n(97))+(d(10,2)*n(98))+(d(10,3)*n(99))+(d(10,4)*n(100)))-(n(37)+n(85)+n(38)+n(86)+n(39)+n(87)+n(40)+n(88));
% C(24)=(n(37)+n(85)+n(38)+n(86)+n(39)+n(87)+n(40)+n(88))-((d(10,1)*n(97))+(d(10,2)*n(98))+(d(10,3)*n(99))+(d(10,4)*n(100)));
% % C(46)=0.7*((d(11,1)*n(97))+(d(11,2)*n(98))+(d(11,3)*n(99))+(d(11,4)*n(100)))-(n(41)+n(89)+n(42)+n(90)+n(43)+n(91)+n(44)+n(92));
% C(25)=(n(41)+n(89)+n(42)+n(90)+n(43)+n(91)+n(44)+n(92))-((d(11,1)*n(97))+(d(11,2)*n(98))+(d(11,3)*n(99))+(d(11,4)*n(100)));
% % C(48)=0.7*((d(12,1)*n(97))+(d(12,2)*n(98))+(d(12,3)*n(99))+(d(12,4)*n(100)))-(n(45)+n(93)+n(46)+n(94)+n(47)+n(95)+n(48)+n(96));
% C(26)=(n(45)+n(93)+n(46)+n(94)+n(47)+n(95)+n(48)+n(96))-((d(12,1)*n(97))+(d(12,2)*n(98))+(d(12,3)*n(99))+(d(12,4)*n(100)));
% % -----------------------------------
% C(27)= 0.4 - gama (1);
% C(28)= 0.4 - gama (2);
% C(29)= 0.4 - gama (3);
% C(30)= 0.4 - gama (4);
% 
% for i=1:numel(C)
%     if C(i)>0
% %         C(i) = exp(C(i)) / ( 1 + exp(C(i)) ) ;
%         C(i) = atan (C(i) );
% %         C(i)=1;
%     else
%         C(i)=0;
%     end
% end
%  y = (1/(1+exp(-sum(C(1:30)))));
% y*sum(C(1:30))
% z(t1)=z(t1)*5^sum(C(1:30));
% z(t2)=z(t2)*5^sum(C(1:30));
% z(t3)=z(t3)*5^sum(C(1:30));
% z(t4)=z(t4)*5^sum(C(1:30));

z=[z(t1) z(t2) z(t3) z(t4)];
end

